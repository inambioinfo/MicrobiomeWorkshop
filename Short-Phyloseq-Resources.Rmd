---
title: "Pointers to statistical analysis of Microbiome Data (in R)"
author: Susan Holmes
affiliation: Stanford University
date: 2017-07-27
output: 
  slidy_presentation:
    font_adjustment: +1
---

<link href='http://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet' type='text/css'>

<style type="text/css"> 
.small-code pre code {
  font-size: 1em;
}
body{
  font-family: Lato;
  font-size: 24pt;
}
h1{
  font-family: Lato;
  font-size: 32pt;
  color: #0080FF;
}
h2,h3,h4,h5,h6{
  font-family: Lato;
  font-size: 24pt;
  color: #0080FF;
}
</style>
```{r initialize, echo = FALSE, warning = FALSE}
## Set default options for code chunks
knitr::opts_chunk$set(tidy = FALSE, cache = TRUE, autodep = TRUE,
     dev = "png", dpi = 300,
     size = "small",
     message = FALSE, error = FALSE, warning = TRUE)
## output width
base::options(width = 70,  continue = " ")
## set seed - to have reproducibility
set.seed(0xbedada)
```

# Goals for these slides: only pointers

-   Phyloseq: Data integration
-   Transformations, filtering
-   Testing tools: networks, hierarchical testing, DESeq2, ..
-   Data integration, CCA, DPCOA,..
-   Reproducible Research: available Rmd files

# Phyloseq


<div style="text-align: center;"> 
![Phyloseq API](../../Dropbox/images/WorkflowPhyloseqdada2.png){width="50%"} 

Heterogeneous Data Objects: S4 classes </div>
(McMurdie and Holmes, 2013, Plos ONE).

<div style="text-align: center;"> 
![phyloseq-measures-ggplot2](../../Dropbox/images/phyloseqthumbnails.png){width="50%"}
</div>

<div style="text-align: center;"> 
![phyloseq-ordinations](../../Dropbox/images/phyloseqtb2.png){width="50%"}
All standard  ordinations.
</div>


# Variance stabilizing using DESeq2

![VST](/Users/susan/Dropbox/images/VST_Huber.png)
Wolfgang Huber


The way the authors proceed is to follow the `rarefying path`, this is not recommended and
a much better procedure is to use DESeq with phyloseq,
see the wiki here:

[DESeq with phyloseq wiki](https://bioconductor.org/packages/devel/bioc/vignettes/phyloseq/inst/doc/phyloseq-mixture-models.html)

<div style="text-align: center;"> 
![phyloseq-testing-deseq](../../Dropbox/images/phyloseqdeseq2.png){width="50%"}
</div>


[Waste Not want not supplement](http://joey711.github.io/waste-not-supplemental/)

# Testing links between communities and factor covariates

<div style="text-align: center;"> 
![phyloseq-networks](../../Dropbox/images/MouseNetwork.png){width="50%"}
</div>

[Friedman Rafsky Tests](http://web.stanford.edu/class/bios221/MicrobiomeWorkflowII.html#graph-based_analyses)

Package: [phyloseqGraphTest](https://github.com/jfukuyama/phyloseqGraphTest)

# Hierarchical testing (Kris Sankaran)

![Using the tree](../../Books/CUBook/images/structssi-screenshot.png)

[In the Workflow](http://web.stanford.edu/class/bios221/MicrobiomeWorkflowII.html#hierarchical_multiple_testing)

Taking account of the phylogenetic tree when testing: 

 - CRAN package: [structSSI](https://cran.r-project.org/web/packages/structSSI/index.html)    
 - Journ. Stat. Software paper [JSS link](https://www.jstatsoft.org/article/view/v059i13)

# Multiple table analyses

## Sparse Canonical Correlation Analysis:
![Triplot](../../Dropbox/images/multitable-triplot.png){width="50%"}


[In the Workflow](http://web.stanford.edu/class/bios221/MicrobiomeWorkflowII.html#multitable_techniques)

# Modulated DPCoA

![DPCoA start with taxa](../../Dropbox/images/DPCoA_taxa.png){width="50%"}

CRAN package (with shiny adaptation): [adaptiveGPCA](https://cran.r-project.org/web/packages/adaptiveGPCA/index.html)

# Multiple choices: example of the Enterotypes data:

![Nature Paper](/Users/susan/Dropbox/images/EnterotypeBCA.png)
[Reproducible Research](http://statweb.stanford.edu/~susan/papers/EnterotypeRR.html)


#Longitudinal Data Analyses

![Perturbation Design](../../Dropbox/images/SamplingDesignSmall.png){width="60%"}

## Vaginal Microbiome and Pregnancy

![Markov Model](../../Dropbox/images/MarkovChainGraph.png){width="60%"}

[All Rmd and htmls for PNAS](http://statweb.stanford.edu/~susan/papers/PNASRR.html)

# Looking at longitudinal data in the presence of a tree using treelapse.

![Example Sankey](../../Dropbox/images/treelapse_Sankey.png){width="60%"}

[Howto Sankey](http://krisrs1128.github.io/treelapse_expers/doi_compare/doi_exper.html)

![Example Treebox (Kris Sankaran)](../../Dropbox/images/treelapse_box.png){width="60%"}

[Tutorial to follow (Kris Sankaran)](http://statweb.stanford.edu/~kriss1/antibiotic.html)


#References

[Workflow paper](https://f1000research.com/articles/5-1492/v2)

[Workflow html](http://web.stanford.edu/class/bios221/MicrobiomeWorkflowII.html)

[Reproducible Research links](http://statweb.stanford.edu/~susan/papers/PSBRR.html)